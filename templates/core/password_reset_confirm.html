{% extends "core/base.html" %}
{% load static %}

{% block title %}SWGFV - Restablecer contraseña{% endblock %}

{% block head %}
<style>
  body {
    margin: 0;
    min-height: 100vh;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #001F3F;
  }
  .bg-wrap { position: fixed; inset: 0; z-index: -2;
    background-image: url('{% static "core/img/imagen1.jpg" %}');
    background-size: cover; background-position: center;
    filter: blur(2px) brightness(1.15);
  }
  .bg-overlay { position: fixed; inset: 0; z-index: -1; background: rgba(0,0,0,0.20); }

  .brand-bar { background-color: rgba(255,255,255,0.95); box-shadow: 0 2px 6px rgba(0,0,0,0.2); }
  .brand-title { color: #001F3F; font-size: 1rem; line-height: 1.2; margin: 0; }

  .card-box {
    background-color: rgba(255,255,255,0.95);
    border-radius: 16px;
    box-shadow: 0 0 20px rgba(0, 0, 50, 0.30);
    border: 0;
  }
  .btn-primary-custom { background-color: #C8102E; border: none; font-weight: 700; }
  .btn-primary-custom:hover { filter: brightness(0.95); }
</style>
{% endblock %}

{% block content %}
<div class="bg-wrap"></div>
<div class="bg-overlay"></div>

<header class="brand-bar py-2">
  <div class="container">
    <div class="d-flex align-items-center gap-3">
      <img src="{% static 'core/img/logo1.png' %}" alt="Logo Fortia Pv" style="height: 90px; width:auto;">
      <h1 class="brand-title flex-grow-1">
        Sistema web de gestión de proyectos fotovoltaicos SWGFV para la empresa Fortia Pv
      </h1>
    </div>
  </div>
</header>

<main class="container py-4">
  <div class="row justify-content-center">
    <div class="col-12 col-sm-10 col-md-7 col-lg-5">
      <div class="card card-box p-3 p-sm-4 mt-3">
        <div class="card-body">
          <h2 class="text-center mb-3" style="color:#001F3F; font-weight:800;">Restablecer contraseña</h2>

          <p class="text-center mb-3" style="color:#001F3F; opacity:.85;">
            Cuenta: <strong>{{ email }}</strong>
          </p>

          {% if messages %}
            {% for message in messages %}
              <div class="alert alert-{% if message.tags %}{{ message.tags }}{% else %}danger{% endif %} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
              </div>
            {% endfor %}
          {% endif %}

          <form method="POST" novalidate>
            {% csrf_token %}

            <label class="form-label fw-bold" style="color:#001F3F;">Nueva contraseña:</label>
            {{ form.new_password }}
            {% if form.new_password.errors %}<div class="text-danger mt-1">{{ form.new_password.errors }}</div>{% endif %}

            <label class="form-label fw-bold mt-3" style="color:#001F3F;">Confirmar contraseña:</label>
            {{ form.new_password_confirm }}
            {% if form.new_password_confirm.errors %}<div class="text-danger mt-1">{{ form.new_password_confirm.errors }}</div>{% endif %}

            <button type="submit" class="btn btn-primary-custom w-100 py-2 mt-4">
              Guardar contraseña
            </button>
          </form>

          <div class="text-center mt-3 small" style="color:#001F3F;">
            © 2025 Sistema de Administración Fotovoltaica
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
